<!-- Tab: R0 Management -->
<div v-show="currentTab === 'r0'">
  <div class="section-header">
    <h2>標籤管理</h2>
    <div style="display: flex; gap: 0.5rem; align-items: center;">
      <span :class="['badge', printerConnected ? 'badge-success' : 'badge-warning']">
        {{ printerConnected ? 'SATO 印表機已連線' : '印表機離線 (模擬模式)' }}
      </span>
      <button class="btn btn-sm btn-ghost" @click="showPrinterSettingsModal = true">
        <i data-lucide="settings" class="w-4 h-4"></i>
        設定
      </button>
    </div>
  </div>

  <!-- Sub-tabs for R0 functions -->
  <div class="sub-tabs" style="margin-bottom: 1rem;">
    <button :class="['btn btn-sm', r0SubTab === 'generate' ? 'btn-primary' : 'btn-ghost']"
            @click="r0SubTab = 'generate'">
      <i data-lucide="tag" class="w-4 h-4"></i>
      標籤產生
    </button>
    <button :class="['btn btn-sm', r0SubTab === 'query' ? 'btn-primary' : 'btn-ghost']"
            @click="r0SubTab = 'query'">
      <i data-lucide="search" class="w-4 h-4"></i>
      標籤查詢
    </button>
    <button :class="['btn btn-sm', r0SubTab === 'replace' ? 'btn-primary' : 'btn-ghost']"
            @click="r0SubTab = 'replace'">
      <i data-lucide="replace" class="w-4 h-4"></i>
      RFID 更換
    </button>
    <button :class="['btn btn-sm', r0SubTab === 'upgrade' ? 'btn-primary' : 'btn-ghost']"
            @click="r0SubTab = 'upgrade'">
      <i data-lucide="arrow-up-circle" class="w-4 h-4"></i>
      狀態升級
    </button>
  </div>

  <!-- Sub-tab: Generate Labels -->
  <div v-show="r0SubTab === 'generate'" class="form-section">
    <h4 style="margin: 0 0 1rem; color: #475569;">
      <i data-lucide="tag" class="w-4 h-4" style="display: inline;"></i>
      標籤產生 (首次綁定 EPC)
    </h4>

    <div class="form-grid">
      <div style="grid-column: span 2;">
        <label class="input-label">選擇工單 *</label>
        <select class="select select-bordered w-full" v-model="formR0Generate.workOrderId" @change="onR0WorkOrderSelect">
          <option value="">-- 選擇工單 --</option>
          <option v-for="wo in workOrders.filter(w => w.status !== 'completed' && w.status !== 'cancelled')"
                  :key="wo.id" :value="wo.id">
            {{ wo.orderNumber }} - {{ wo.customerName }} ({{ wo.productModel }})
          </option>
        </select>
      </div>

      <div>
        <label class="input-label">列印數量 *</label>
        <input type="number" class="input input-bordered w-full"
               v-model.number="formR0Generate.quantity" min="1" max="1000" placeholder="列印張數">
      </div>

      <div>
        <label class="input-label">廠區代碼</label>
        <input type="text" class="input input-bordered w-full"
               v-model="formR0Generate.areaCode" placeholder="例如: A、B、C">
      </div>

      <div>
        <label class="input-label">客戶代碼 (EPC用)</label>
        <input type="text" class="input input-bordered w-full"
               v-model="formR0Generate.customerCode" placeholder="自動帶入" style="text-transform: uppercase;">
      </div>

      <div>
        <label class="input-label">產品代碼 (EPC用)</label>
        <input type="text" class="input input-bordered w-full"
               v-model="formR0Generate.productCode" placeholder="自動帶入" style="text-transform: uppercase;">
      </div>
    </div>

    <!-- R0 Code Preview -->
    <div class="r0-preview-section" v-if="formR0Generate.workOrderId">
      <h5>編碼預覽</h5>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div>
          <div class="r0-format-hint" style="margin-bottom: 0.25rem;">R0 編碼 (標籤條碼)</div>
          <div class="r0-code-preview">
            <code>{{ r0CodePreview }}</code>
          </div>
        </div>
        <div>
          <div class="r0-format-hint" style="margin-bottom: 0.25rem;">EPC 編碼 (RFID 晶片)</div>
          <div class="r0-code-preview" style="background: linear-gradient(135deg, #ecfdf5, #d1fae5);">
            <code style="color: #047857;">{{ epcPreview }}</code>
          </div>
        </div>
      </div>
    </div>

    <!-- Generate Queue -->
    <div class="r0-queue-section" v-if="r0GenerateQueue.length > 0">
      <h5>待列印佇列 ({{ r0GenerateQueue.length }} 張)</h5>
      <div class="r0-queue-list scrollable" style="max-height: 200px;">
        <div v-for="(item, idx) in r0GenerateQueue" :key="idx" class="r0-queue-item">
          <span class="queue-index">{{ idx + 1 }}</span>
          <code>{{ item.r0Code }}</code>
          <span :class="['badge', item.status === 'printed' ? 'badge-success' : (item.status === 'printing' ? 'badge-warning' : 'badge-ghost')]">
            {{ item.status === 'printed' ? '已列印' : (item.status === 'printing' ? '列印中' : '待列印') }}
          </span>
          <span v-if="item.epc" class="epc-tag">EPC: {{ item.epc }}</span>
        </div>
      </div>
    </div>

    <div class="form-actions" style="margin-top: 1.5rem;">
      <button class="btn btn-primary" @click="generateR0Labels" :disabled="!formR0Generate.workOrderId || !formR0Generate.quantity">
        <i data-lucide="plus" class="w-4 h-4"></i>
        產生 R0 標籤
      </button>
      <button class="btn btn-success" @click="startR0Printing" :disabled="r0GenerateQueue.length === 0">
        <i data-lucide="printer" class="w-4 h-4"></i>
        SATO 列印
      </button>
      <button class="btn btn-info" @click="printLabelPreview" :disabled="r0GenerateQueue.length === 0">
        <i data-lucide="eye" class="w-4 h-4"></i>
        瀏覽器列印
      </button>
      <button class="btn btn-ghost" @click="clearR0Queue" :disabled="r0GenerateQueue.length === 0">
        清除佇列
      </button>
    </div>

    <!-- EPC Auto-Generation Section -->
    <div class="form-section" style="margin-top: 1.5rem; background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); border: 1px solid #10b981;">
      <h5 style="color: #047857; margin: 0 0 0.75rem;">
        <i data-lucide="cpu" class="w-4 h-4" style="display: inline;"></i>
        EPC 自動產生
      </h5>

      <!-- EPC Format Explanation -->
      <div style="background: white; border-radius: 0.5rem; padding: 0.75rem; margin-bottom: 1rem; font-size: 0.8rem;">
        <div style="font-weight: 600; margin-bottom: 0.5rem; color: #065f46;">EPC 編碼格式 (24 位 Hex)</div>
        <div style="display: flex; gap: 0.25rem; flex-wrap: wrap; margin-bottom: 0.5rem;">
          <code style="background: #dbeafe; padding: 0.2rem 0.4rem; border-radius: 0.25rem; color: #1e40af;">E2</code>
          <span style="color: #6b7280;">+</span>
          <code style="background: #fce7f3; padding: 0.2rem 0.4rem; border-radius: 0.25rem; color: #9d174d;">{{ formR0Generate.customerCode || 'XXXX' }}</code>
          <span style="color: #6b7280;">+</span>
          <code style="background: #fef3c7; padding: 0.2rem 0.4rem; border-radius: 0.25rem; color: #92400e;">{{ formR0Generate.productCode || 'XXXX' }}</code>
          <span style="color: #6b7280;">+</span>
          <code style="background: #e0e7ff; padding: 0.2rem 0.4rem; border-radius: 0.25rem; color: #3730a3;">{{ new Date().getFullYear().toString().slice(-2) }}</code>
          <span style="color: #6b7280;">+</span>
          <code style="background: #f3e8ff; padding: 0.2rem 0.4rem; border-radius: 0.25rem; color: #6b21a8;">序號(12位)</code>
        </div>
        <div style="color: #6b7280; font-size: 0.75rem;">
          範例: <code style="background: #f1f5f9; padding: 0.15rem 0.3rem; border-radius: 0.25rem;">E2TSM0HP1026000000000001</code>
        </div>
      </div>

      <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
        <button class="btn btn-sm btn-success" @click="autoGenerateAllEpc"
                :disabled="r0GenerateQueue.filter(i => !i.epc).length === 0">
          <i data-lucide="zap" class="w-4 h-4"></i>
          自動產生全部 EPC ({{ r0GenerateQueue.filter(i => !i.epc).length }} 筆)
        </button>
        <span style="color: #6b7280; font-size: 0.75rem; align-self: center;">
          目前序號: {{ epcSerialCounter }}
        </span>
      </div>
    </div>

    <!-- Simulation Mode Section (Manual EPC) -->
    <div class="form-section" style="margin-top: 1rem; background: #fef3c7; border: 1px dashed #f59e0b;">
      <h5 style="color: #92400e; margin: 0 0 0.75rem;">
        <i data-lucide="flask-conical" class="w-4 h-4" style="display: inline;"></i>
        手動綁定模式 (測試或特殊情況)
      </h5>
      <div class="form-grid">
        <div>
          <label class="input-label">R0 編碼</label>
          <select class="select select-bordered w-full" v-model="formR0Simulate.r0Code">
            <option value="">-- 選擇待綁定的 R0 --</option>
            <option v-for="item in r0GenerateQueue.filter(i => !i.epc)" :key="item.r0Code" :value="item.r0Code">
              {{ item.r0Code }}
            </option>
          </select>
        </div>
        <div>
          <label class="input-label">手動輸入 EPC</label>
          <input type="text" class="input input-bordered w-full"
                 v-model="formR0Simulate.epc" placeholder="24 位 Hex，例如: E2TSM0HP10...">
        </div>
      </div>
      <button class="btn btn-sm btn-warning" style="margin-top: 0.75rem;" @click="simulateEpcCallback"
              :disabled="!formR0Simulate.r0Code">
        <i data-lucide="check" class="w-4 h-4"></i>
        {{ formR0Simulate.epc ? '手動綁定 EPC' : '自動產生並綁定' }}
      </button>
    </div>
  </div>

  <!-- Sub-tab: Query Labels -->
  <div v-show="r0SubTab === 'query'" class="form-section">
    <h4 style="margin: 0 0 1rem; color: #475569;">
      <i data-lucide="search" class="w-4 h-4" style="display: inline;"></i>
      標籤查詢
    </h4>

    <div class="form-grid">
      <div style="grid-column: span 2;">
        <label class="input-label">掃描 R0 條碼 / 輸入 EPC</label>
        <div class="scan-input-row">
          <input type="text" class="input input-bordered flex-1"
                 v-model="r0QueryInput" @keyup.enter="queryR0Label"
                 placeholder="掃描條碼或輸入 R0 編碼 / EPC...">
          <button class="btn btn-primary" @click="queryR0Label">
            <i data-lucide="search" class="w-4 h-4"></i>
            查詢
          </button>
        </div>
      </div>
    </div>

    <!-- Query Result -->
    <div v-if="r0QueryResult" class="r0-query-result">
      <div class="result-header">
        <h5>查詢結果</h5>
        <span :class="['badge', 'badge-lg', r0QueryResult.status === 'active' ? 'badge-success' : 'badge-error']">
          {{ r0QueryResult.status === 'active' ? '使用中' : '已停用' }}
        </span>
      </div>

      <div class="result-info-grid">
        <div class="info-item">
          <label>R0 編碼</label>
          <code>{{ r0QueryResult.r0Code }}</code>
        </div>
        <div class="info-item">
          <label>目前 EPC</label>
          <code>{{ r0QueryResult.currentEpc || '-' }}</code>
        </div>
        <div class="info-item">
          <label>目前狀態</label>
          <span class="status-badge">{{ r0QueryResult.regenerationStatus || 'R0' }}</span>
        </div>
        <div class="info-item">
          <label>再生次數</label>
          <span>{{ r0QueryResult.regenerationCount || 0 }} 次</span>
        </div>
        <div class="info-item">
          <label>工單號</label>
          <span>{{ r0QueryResult.orderNumber || '-' }}</span>
        </div>
        <div class="info-item">
          <label>客戶/廠區</label>
          <span>{{ r0QueryResult.customerName || '-' }} / {{ r0QueryResult.areaCode || '-' }}</span>
        </div>
        <div class="info-item">
          <label>產品型號</label>
          <span>{{ r0QueryResult.productModel || '-' }}</span>
        </div>
        <div class="info-item">
          <label>建立時間</label>
          <span>{{ r0QueryResult.createdAt ? new Date(r0QueryResult.createdAt).toLocaleString('zh-TW') : '-' }}</span>
        </div>
      </div>

      <!-- History Timeline -->
      <div class="r0-history-section" v-if="r0QueryResult.history && r0QueryResult.history.length > 0">
        <h5>異動歷程</h5>
        <div class="history-timeline">
          <div v-for="(event, idx) in r0QueryResult.history" :key="idx" class="timeline-item">
            <div class="timeline-dot" :class="event.type"></div>
            <div class="timeline-content">
              <div class="timeline-title">{{ event.action }}</div>
              <div class="timeline-detail">{{ event.detail }}</div>
              <div class="timeline-time">{{ new Date(event.timestamp).toLocaleString('zh-TW') }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div v-else-if="r0QueryInput === '' && !r0QueryResult" class="empty-state" style="padding: 3rem;">
      <i data-lucide="scan" class="w-12 h-12 mx-auto mb-4 opacity-30"></i>
      <div>掃描或輸入 R0 編碼 / EPC 進行查詢</div>
    </div>
  </div>

  <!-- Sub-tab: Replace RFID -->
  <div v-show="r0SubTab === 'replace'" class="form-section">
    <h4 style="margin: 0 0 1rem; color: #475569;">
      <i data-lucide="replace" class="w-4 h-4" style="display: inline;"></i>
      RFID 更換 (AOI 檢驗不良更換)
    </h4>

    <div class="alert alert-info" style="margin-bottom: 1rem;">
      <i data-lucide="info" class="w-4 h-4"></i>
      <span>掃描 AOI 檢驗不良的標籤條碼，系統將保留相同 R0 編碼，列印新標籤並寫入新 EPC</span>
    </div>

    <div class="form-grid">
      <div style="grid-column: span 2;">
        <label class="input-label">掃描舊標籤條碼 *</label>
        <div class="scan-input-row">
          <input type="text" class="input input-bordered flex-1"
                 v-model="formR0Replace.oldBarcode" @keyup.enter="lookupOldR0"
                 placeholder="掃描舊標籤上的一維/二維條碼...">
          <button class="btn btn-ghost" @click="lookupOldR0">
            <i data-lucide="search" class="w-4 h-4"></i>
            查詢
          </button>
        </div>
      </div>
    </div>

    <!-- Old Label Info -->
    <div v-if="formR0Replace.oldLabelInfo" class="old-label-info">
      <h5>舊標籤資訊</h5>
      <div class="result-info-grid">
        <div class="info-item">
          <label>R0 編碼</label>
          <code>{{ formR0Replace.oldLabelInfo.r0Code }}</code>
        </div>
        <div class="info-item">
          <label>舊 EPC</label>
          <code class="text-error">{{ formR0Replace.oldLabelInfo.epc }}</code>
        </div>
        <div class="info-item">
          <label>目前狀態</label>
          <span>{{ formR0Replace.oldLabelInfo.regenerationStatus || 'R0' }}</span>
        </div>
        <div class="info-item">
          <label>工單號</label>
          <span>{{ formR0Replace.oldLabelInfo.orderNumber || '-' }}</span>
        </div>
      </div>

      <div class="form-grid" style="margin-top: 1rem;">
        <div>
          <label class="input-label">更換原因 *</label>
          <select class="select select-bordered w-full" v-model="formR0Replace.reason">
            <option value="">-- 選擇原因 --</option>
            <option value="aoi_defect">AOI 檢驗不良</option>
            <option value="damaged">標籤損壞</option>
            <option value="unreadable">無法讀取</option>
            <option value="other">其他</option>
          </select>
        </div>
        <div>
          <label class="input-label">操作員 *</label>
          <select class="select select-bordered w-full" v-model="formR0Replace.operatorName">
            <option value="">-- 選擇操作員 --</option>
            <option v-for="op in operators" :key="op.id" :value="op.name">{{ op.name }}</option>
          </select>
        </div>
      </div>

      <div class="form-actions" style="margin-top: 1.5rem;">
        <button class="btn btn-warning" @click="printReplacementLabel"
                :disabled="!formR0Replace.reason || !formR0Replace.operatorName">
          <i data-lucide="printer" class="w-4 h-4"></i>
          列印更換標籤
        </button>
        <button class="btn btn-ghost" @click="clearReplaceForm">取消</button>
      </div>

      <!-- New EPC Input (simulation) -->
      <div v-if="formR0Replace.pendingNewLabel" class="form-section" style="margin-top: 1rem; background: #fef3c7; border: 1px dashed #f59e0b;">
        <h5 style="color: #92400e;">新標籤 EPC 回報</h5>
        <div class="scan-input-row">
          <input type="text" class="input input-bordered flex-1"
                 v-model="formR0Replace.newEpc" placeholder="輸入新 EPC (印表機回報或手動輸入)...">
          <button class="btn btn-success" @click="confirmReplacement" :disabled="!formR0Replace.newEpc">
            <i data-lucide="check" class="w-4 h-4"></i>
            確認更換
          </button>
        </div>
      </div>
    </div>

    <div v-else class="empty-state" style="padding: 3rem;">
      <i data-lucide="scan" class="w-12 h-12 mx-auto mb-4 opacity-30"></i>
      <div>掃描需要更換的舊標籤條碼</div>
    </div>
  </div>

  <!-- Sub-tab: Status Upgrade -->
  <div v-show="r0SubTab === 'upgrade'" class="form-section">
    <h4 style="margin: 0 0 1rem; color: #475569;">
      <i data-lucide="arrow-up-circle" class="w-4 h-4" style="display: inline;"></i>
      狀態升級 (再生次數更新)
    </h4>

    <div class="alert alert-info" style="margin-bottom: 1rem;">
      <i data-lucide="info" class="w-4 h-4"></i>
      <span>濾網再生完成後，掃描標籤升級狀態: R0 → R1 → R2 → ... → R5 (最多 5 次再生)</span>
    </div>

    <div class="form-grid">
      <div style="grid-column: span 2;">
        <label class="input-label">掃描標籤條碼</label>
        <div class="scan-input-row">
          <input type="text" class="input input-bordered flex-1"
                 v-model="formR0Upgrade.barcode" @keyup.enter="lookupForUpgrade"
                 placeholder="掃描再生完成的標籤條碼...">
          <button class="btn btn-ghost" @click="lookupForUpgrade">
            <i data-lucide="search" class="w-4 h-4"></i>
            查詢
          </button>
        </div>
      </div>
    </div>

    <!-- Upgrade Info -->
    <div v-if="formR0Upgrade.labelInfo" class="upgrade-info-section">
      <div class="upgrade-status-display">
        <div class="current-status">
          <label>目前狀態</label>
          <span class="status-badge large">{{ formR0Upgrade.labelInfo.regenerationStatus || 'R0' }}</span>
        </div>
        <div class="status-arrow">
          <i data-lucide="arrow-right" class="w-6 h-6"></i>
        </div>
        <div class="new-status">
          <label>升級後狀態</label>
          <span class="status-badge large new" v-if="canUpgradeR0">
            R{{ (parseInt((formR0Upgrade.labelInfo.regenerationStatus || 'R0').replace('R', '')) || 0) + 1 }}
          </span>
          <span class="status-badge large error" v-else>已達上限</span>
        </div>
      </div>

      <div class="result-info-grid" style="margin-top: 1rem;">
        <div class="info-item">
          <label>R0 編碼</label>
          <code>{{ formR0Upgrade.labelInfo.r0Code }}</code>
        </div>
        <div class="info-item">
          <label>目前 EPC</label>
          <code>{{ formR0Upgrade.labelInfo.currentEpc }}</code>
        </div>
        <div class="info-item">
          <label>再生次數</label>
          <span>{{ formR0Upgrade.labelInfo.regenerationCount || 0 }} / 5 次</span>
        </div>
        <div class="info-item">
          <label>工單號</label>
          <span>{{ formR0Upgrade.labelInfo.orderNumber || '-' }}</span>
        </div>
      </div>

      <div v-if="!canUpgradeR0" class="alert alert-error" style="margin-top: 1rem;">
        <i data-lucide="alert-triangle" class="w-4 h-4"></i>
        <span>此濾網已達再生次數上限 (5 次)，無法繼續升級，須報廢處理</span>
      </div>

      <div class="form-grid" style="margin-top: 1rem;" v-if="canUpgradeR0">
        <div>
          <label class="input-label">操作員 *</label>
          <select class="select select-bordered w-full" v-model="formR0Upgrade.operatorName">
            <option value="">-- 選擇操作員 --</option>
            <option v-for="op in operators" :key="op.id" :value="op.name">{{ op.name }}</option>
          </select>
        </div>
        <div>
          <label class="input-label">備註</label>
          <input type="text" class="input input-bordered w-full"
                 v-model="formR0Upgrade.notes" placeholder="選填">
        </div>
      </div>

      <div class="form-actions" style="margin-top: 1.5rem;">
        <button class="btn btn-success" @click="performStatusUpgrade"
                :disabled="!canUpgradeR0 || !formR0Upgrade.operatorName">
          <i data-lucide="arrow-up-circle" class="w-4 h-4"></i>
          確認升級並列印新標籤
        </button>
        <button class="btn btn-ghost" @click="clearUpgradeForm">取消</button>
      </div>
    </div>

    <div v-else class="empty-state" style="padding: 3rem;">
      <i data-lucide="scan" class="w-12 h-12 mx-auto mb-4 opacity-30"></i>
      <div>掃描需要升級狀態的標籤條碼</div>
    </div>
  </div>

  <!-- R0 Labels Table -->
  <div class="form-section" style="margin-top: 1.5rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
      <h4 style="margin: 0; color: #475569;">
        <i data-lucide="database" class="w-4 h-4" style="display: inline;"></i>
        標籤紀錄
      </h4>
      <div style="display: flex; gap: 0.5rem; align-items: center;">
        <input type="text" class="input input-bordered input-sm" style="width: 200px;"
               v-model="r0TableFilter" placeholder="搜尋 R0 / EPC / 工單...">
        <span class="badge badge-ghost">共 {{ filteredR0Labels.length }} 筆</span>
      </div>
    </div>

    <div class="table-container scrollable" style="max-height: 400px;">
      <table class="table table-sm">
        <thead>
          <tr>
            <th>R0 編碼</th>
            <th>EPC</th>
            <th>狀態</th>
            <th>工單號</th>
            <th>客戶</th>
            <th>建立時間</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="label in filteredR0Labels.slice(0, 50)" :key="label.id">
            <td><code class="text-sm">{{ label.r0Code }}</code></td>
            <td><code class="text-xs">{{ label.currentEpc ? label.currentEpc.slice(0, 16) + '...' : '-' }}</code></td>
            <td>
              <span :class="['badge', 'badge-sm', getR0StatusClass(label.regenerationStatus)]">
                {{ label.regenerationStatus || 'R0' }}
              </span>
            </td>
            <td>{{ label.orderNumber || '-' }}</td>
            <td>{{ label.customerName || '-' }}</td>
            <td>{{ label.createdAt ? new Date(label.createdAt).toLocaleDateString('zh-TW') : '-' }}</td>
            <td>
              <div class="btn-group">
                <button class="btn btn-xs btn-ghost" @click="viewR0Detail(label)" title="查看詳情">
                  <i data-lucide="eye" class="w-3 h-3"></i>
                </button>
                <button class="btn btn-xs btn-ghost" @click="reprintLabel(label)" title="補印標籤">
                  <i data-lucide="printer" class="w-3 h-3"></i>
                </button>
              </div>
            </td>
          </tr>
          <tr v-if="filteredR0Labels.length === 0">
            <td colspan="7" class="text-center" style="padding: 2rem; color: #94a3b8;">
              尚無 R0 標籤紀錄
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Printer Settings Modal -->
<div v-if="showPrinterSettingsModal" class="modal modal-open">
  <div class="modal-box">
    <h3 class="font-bold text-lg mb-4">印表機設定</h3>

    <div style="margin-bottom: 1rem;">
      <label class="input-label">印表機類型</label>
      <select class="select select-bordered w-full" v-model="printerConfig.type">
        <option value="sato">SATO CL4NX Plus (RFID)</option>
        <option value="generic">一般印表機 (測試用)</option>
      </select>
    </div>

    <div style="margin-bottom: 1rem;">
      <label class="input-label">連接方式</label>
      <select class="select select-bordered w-full" v-model="printerConfig.connection">
        <option value="usb">USB</option>
        <option value="network">網路</option>
      </select>
    </div>

    <div v-if="printerConfig.connection === 'network'" style="margin-bottom: 1rem;">
      <label class="input-label">IP 位址</label>
      <input type="text" class="input input-bordered w-full"
             v-model="printerConfig.ip" placeholder="192.168.1.100">
    </div>

    <div style="margin-bottom: 1rem;">
      <label class="label cursor-pointer justify-start gap-2">
        <input type="checkbox" class="toggle toggle-primary" v-model="printerConfig.simulationMode">
        <span class="label-text">啟用模擬模式 (無實體印表機時使用)</span>
      </label>
    </div>

    <div class="divider"></div>

    <div style="margin-bottom: 1rem;">
      <h4 style="margin: 0 0 0.5rem;">R0 編碼設定</h4>
      <div class="form-grid">
        <div>
          <label class="input-label">年份前綴</label>
          <input type="text" class="input input-bordered w-full"
                 v-model="printerConfig.yearPrefix" placeholder="YCD">
        </div>
        <div>
          <label class="input-label">序號起始</label>
          <input type="number" class="input input-bordered w-full"
                 v-model.number="printerConfig.serialStart" min="1">
        </div>
      </div>
    </div>

    <div class="modal-action">
      <button class="btn btn-ghost" @click="showPrinterSettingsModal = false">取消</button>
      <button class="btn btn-primary" @click="savePrinterSettings">儲存</button>
    </div>
  </div>
  <div class="modal-backdrop" @click="showPrinterSettingsModal = false"></div>
</div>
