<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <?!= include('styles'); ?>
</head>
<body>
  <div id="app">

    <!-- Loading Overlay -->
    <div v-if="loading" class="loading-overlay">
      <sl-spinner></sl-spinner>
      <div style="font-weight: 600; color: #667eea;">載入中...</div>
    </div>

    <!-- Header -->
    <header class="header-card">
      <div>
        <h1>SMAI - MES 線外表單</h1>
        <p class="subtitle">
          緊急備援作業模式
          <span v-if="version" class="version-badge">v{{ version }}</span>
        </p>
      </div>
      <div style="display: flex; gap: 0.5rem;">
        <sl-button variant="neutral" @click="openShareModal">
          <sl-icon slot="prefix" name="share"></sl-icon>
          分享
        </sl-button>
        <sl-button variant="primary" @click="refreshData">
          <sl-icon slot="prefix" name="arrow-clockwise"></sl-icon>
          重新整理
        </sl-button>
      </div>
    </header>

    <!-- Main Content -->
    <div class="content-card">
      <sl-tab-group @sl-tab-show="e => currentTab = e.detail.name">
        <sl-tab slot="nav" panel="work-orders" :active="currentTab === 'work-orders'">工單管理</sl-tab>
        <sl-tab slot="nav" panel="dispatches" :active="currentTab === 'dispatches'">現場派工</sl-tab>
        <sl-tab slot="nav" panel="reports" :active="currentTab === 'reports'">報工紀錄</sl-tab>
        <sl-tab slot="nav" panel="outgassing" :active="currentTab === 'outgassing'">釋氣檢驗</sl-tab>
        <sl-tab slot="nav" panel="aoi" :active="currentTab === 'aoi'">AOI 檢驗</sl-tab>
        <sl-tab slot="nav" panel="rfid-replace" :active="currentTab === 'rfid-replace'">RFID 更換</sl-tab>
        <sl-tab slot="nav" panel="settings" :active="currentTab === 'settings'">設定</sl-tab>

        <?!= include('tab-work-orders'); ?>
        <?!= include('tab-dispatches'); ?>
        <?!= include('tab-reports'); ?>
        <?!= include('tab-outgassing'); ?>
        <?!= include('tab-aoi'); ?>
        <?!= include('tab-rfid-replace'); ?>
        <?!= include('tab-settings'); ?>
      </sl-tab-group>
    </div>

    <!-- Modals -->
    <?!= include('modals'); ?>

  </div>

  <?!= include('app'); ?>
</body>
</html>
