<!-- Tab: Work Orders -->
<div v-show="currentTab === 'work-orders'">
  <div class="section-header">
    <h2>工單列表</h2>
    <button class="btn btn-success" @click="showCreateWoModal = true">
      <i data-lucide="plus" class="w-4 h-4"></i>
      建立工單
    </button>
  </div>

  <div class="scrollable">
    <table class="data-table">
      <thead>
        <tr>
          <th>單號</th>
          <th>產品/客戶</th>
          <th>類型</th>
          <th>進度</th>
          <th>數量 (完工/總數)</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>
        <tr v-for="wo in workOrders" :key="wo.id">
          <td>
            <span style="font-family: monospace; font-weight: 600;">{{ wo.orderNumber }}</span>
          </td>
          <td>
            <div style="font-weight: 600;">{{ wo.productModel }}</div>
            <div style="font-size: 0.75rem; color: #64748b;">{{ wo.customerName }}</div>
          </td>
          <td>
            <span :class="['badge', wo.orderType === 'regeneration' ? 'badge-warning' : wo.orderType === 'rework' ? 'badge-error' : 'badge-primary']">
              {{ { deglue: '除膠', regeneration: '再生', rework: '重工' }[wo.orderType] || wo.orderType }}
            </span>
            <span v-if="wo.orderType === 'rework' && wo.reworkCount" class="badge badge-error ml-1">
              第{{ wo.reworkCount }}次
            </span>
          </td>
          <td>
            <span :class="'status-badge status-' + (wo.status || 'unknown')">
              {{ { draft: '草稿', pending: '待處理', in_progress: '進行中', completed: '已完成', paused: '暫停' }[wo.status] || wo.status || '未知' }}
            </span>
          </td>
          <td>
            <span style="font-weight: 600;">{{ wo.completedQty }}</span>
            <span style="color: #94a3b8;"> / {{ wo.quantity }}</span>
          </td>
          <td>
            <div style="display: flex; flex-direction: row; gap: 0.5rem; flex-wrap: nowrap;">
              <button v-if="wo.status !== 'completed'" class="btn btn-sm btn-primary" @click="openDispatchModal(wo)">
                派工
              </button>
              <button v-if="wo.status === 'draft'" class="btn btn-sm btn-ghost" @click="startEditWorkOrder(wo)">
                編輯
              </button>
              <button v-if="wo.status === 'draft' || wo.status === 'pending'" class="btn btn-sm btn-outline btn-error" @click="deleteWorkOrder(wo.id)">
                取消
              </button>
              <span v-if="wo.status === 'completed'" class="badge badge-success">已完成</span>
            </div>
          </td>
        </tr>
        <tr v-if="workOrders.length === 0" class="empty-row">
          <td colspan="6">
            <div class="empty-state">
              <i data-lucide="inbox" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
              <div>暫無工單資料</div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
